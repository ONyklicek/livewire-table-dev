# Laravel Livewire Table üìä

Pokroƒçil√Ω, plnƒõ objektov√Ω a server-driven tabulkov√Ω syst√©m pro Laravel s Livewire 3, Alpine.js a Tailwind CSS 3.x/4.x.

[![PHP Version](https://img.shields.io/badge/PHP-8.2%2B-blue)](https://php.net)
[![Laravel](https://img.shields.io/badge/Laravel-11%20%7C%2012-red)](https://laravel.com)
[![Livewire](https://img.shields.io/badge/Livewire-3.0-purple)](https://livewire.laravel.com)
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

---

## üéØ Vlastnosti

- ‚úÖ **SDUI (Server-Driven UI)** - V≈°e konfigurovateln√© z PHP
- ‚úÖ **Inline Editing** - √öprava p≈ô√≠mo v bu≈àk√°ch tabulky
- ‚úÖ **Grouping** - Seskupov√°n√≠ ≈ô√°dk≈Ø s collapsible groups
- ‚úÖ **Sub-rows** - Expandable vno≈ôen√Ω obsah
- ‚úÖ **Column Toggle** - Dynamick√© skr√Ωv√°n√≠/zobrazov√°n√≠ sloupc≈Ø
- ‚úÖ **Saved Filters** - Ulo≈æen√© kombinace filtr≈Ø
- ‚úÖ **Relationships** - Podpora dot notation (`company.name`)
- ‚úÖ **Enum Support** - Automatick√° detekce PHP 8.1+ enums
- ‚úÖ **Responsive** - Mobile/Tablet/Desktop optimalizace
- ‚úÖ **Sorting & Filtering** - Per-column i glob√°ln√≠
- ‚úÖ **Bulk Actions** - Hromadn√© operace
- ‚úÖ **Live Updates** - Auto-refresh ka≈æd√Ωch N sekund
- ‚úÖ **Htmlable** - Pln√° podpora `__toString()` a `toHtml()`
- ‚úÖ **Tailwind 3.x/4.x** - Kompatibiln√≠ s obƒõma verzemi

---

## üìã Po≈æadavky

| Po≈æadavek | Verze |
|-----------|-------|
| PHP | 8.2+ |
| Laravel | 11.x nebo 12.x |
| Livewire | 3.0+ |
| Tailwind CSS | 3.x nebo 4.x |
| Alpine.js | 3.x (zahrnuto v Livewire 3) |

---

## üì¶ Instalace

### Krok 1: Instalace p≈ôes Composer

```bash
composer require nyoncode/livewire-table
```

### Krok 2: Publikov√°n√≠ konfigurace a assets

```bash
# Publikovat konfiguraci
php artisan vendor:publish --tag="livewire-table-config"

# Publikovat migrace (pro Saved Filters)
php artisan vendor:publish --tag="livewire-table-migrations"

# Publikovat views (voliteln√© - pouze pokud chcete customizovat)
php artisan vendor:publish --tag="livewire-table-views"

# Publikovat p≈ôeklady (voliteln√©)
php artisan vendor:publish --tag="livewire-table-translations"
```

### Krok 3: Spu≈°tƒõn√≠ migrac√≠

```bash
php artisan migrate
```

To vytvo≈ô√≠ tabulku `table_filter_presets` pro ukl√°d√°n√≠ u≈æivatelsk√Ωch filtr≈Ø.

### Krok 4: Konfigurace Tailwind CSS

P≈ôidej cesty k package views do `tailwind.config.js`:

#### Pro Tailwind CSS 3.x:

```js
/** @type {import('tailwindcss').Config} */
export default {
    content: [
        './resources/**/*.blade.php',
        './resources/**/*.js',
        './vendor/nyoncode/livewire-table/resources/views/**/*.blade.php',
    ],
    safelist: [
        // Badge colors - nutn√© pro dynamick√© barvy
        'bg-green-100', 'text-green-800', 'ring-green-600/20', 'fill-green-500',
        'bg-red-100', 'text-red-800', 'ring-red-600/20', 'fill-red-500',
        'bg-yellow-100', 'text-yellow-800', 'ring-yellow-600/20', 'fill-yellow-500',
        'bg-blue-100', 'text-blue-800', 'ring-blue-600/20', 'fill-blue-500',
        'bg-gray-100', 'text-gray-800', 'ring-gray-600/20', 'fill-gray-500',
        'bg-orange-100', 'text-orange-800', 'ring-orange-600/20', 'fill-orange-500',
        'bg-purple-100', 'text-purple-800', 'ring-purple-600/20', 'fill-purple-500',
    ],
    theme: {
        extend: {},
    },
    plugins: [],
}
```

#### Pro Tailwind CSS 4.x:

```js
/** @type {import('tailwindcss').Config} */
export default {
    content: [
        './resources/**/*.blade.php',
        './resources/**/*.js',
        './vendor/nyoncode/livewire-table/resources/views/**/*.blade.php',
    ],
    safelist: [
        {
            pattern: /^(bg|text|ring|fill)-(green|red|yellow|blue|gray|orange|purple)-(100|500|800)$/,
        },
    ],
    theme: {
        extend: {},
    },
    plugins: [],
}
```

### Krok 5: Build assets

```bash
npm run build
# nebo pro development
npm run dev
```

### Krok 6: Ovƒõ≈ôen√≠ instalace

Zkontroluj, ≈æe service provider byl zaregistrov√°n:

```bash
php artisan about
```

Mƒõl bys vidƒõt sekci s informacemi o **Livewire Table** package.

---

## üöÄ Rychl√Ω start

### 1. Vytvo≈ô Livewire komponentu

```bash
php artisan make:livewire UsersTable
```

### 2. Implementuj tabulku

```php
<?php

namespace App\Livewire;

use App\Models\User;
use App\Support\Tables\Table;
use App\Support\Tables\Columns\TextColumn;
use App\Support\Tables\Columns\BadgeColumn;
use App\Support\Tables\Filters\TextFilter;
use App\Support\Tables\Filters\SelectFilter;
use App\Support\Tables\Actions\Action;
use Livewire\Component;

class UsersTable extends Component
{
    use \NyonCode\LivewireTable\Livewire\Concerns\HasTable;

    public function table(Table $table): Table
    {
        return $table
            ->model(User::query())
            ->columns([
                TextColumn::make('name')
                    ->label('Jm√©no')
                    ->searchable()
                    ->sortable(),
                
                TextColumn::make('email')
                    ->label('Email')
                    ->searchable()
                    ->sortable(),
                
                BadgeColumn::make('status')
                    ->label('Status')
                    ->colors([
                        'active' => 'green',
                        'inactive' => 'gray',
                    ])
                    ->sortable(),
            ])
            ->filters([
                TextFilter::make('name_filter', 'name')
                    ->label('Jm√©no')
                    ->placeholder('Hledat...'),
                
                SelectFilter::make('status_filter', 'status')
                    ->label('Status')
                    ->options([
                        'active' => 'Aktivn√≠',
                        'inactive' => 'Neaktivn√≠',
                    ]),
            ])
            ->actions([
                Action::make('edit')
                    ->label('Upravit')
                    ->color('blue')
                    ->action(fn($record) => $this->redirect(route('users.edit', $record))),
            ])
            ->perPage(25);
    }

    public function render()
    {
        return view('livewire.users-table');
    }
}
```

### 3. Vytvo≈ô Blade view

```blade
{{-- resources/views/livewire/users-table.blade.php --}}

<div>
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold mb-6">U≈æivatel√©</h1>
        
        {!! $this->table->render() !!}
    </div>
</div>
```

### 4. Pou≈æij v route

```php
use App\Livewire\UsersTable;

Route::get('/users', UsersTable::class);
```

---

## üìò Kompletn√≠ pr≈Øvodce

### Sloupce (Columns)

#### TextColumn

Z√°kladn√≠ textov√Ω sloupec s pokroƒçil√Ωmi funkcemi.

```php
use NyonCode\LivewireTable\Columns\TextColumn;

TextColumn::make('name')
    ->label('Jm√©no')
    ->searchable()      // Lze prohled√°vat
    ->sortable()        // Lze ≈ôadit
    ->copyable()        // Tlaƒç√≠tko pro kop√≠rov√°n√≠
    ->limit(50)         // O≈ô√≠zne text na 50 znak≈Ø
    ->placeholder('‚Äî')  // Zobraz√≠ kdy≈æ je hodnota null
    ->hideOn(['sm', 'md'])  // Skryje na mobilech a tabletech
    ->format(fn($value) => strtoupper($value))  // Custom form√°tov√°n√≠
    ->visible(auth()->user()->isAdmin())  // Podm√≠nƒõn√° viditelnost
    ->hidden(!config('app.debug'))  // Nebo skryt√≠
```

#### BadgeColumn

Barevn√© odznaky pro stavy a kategorie.

```php
use NyonCode\LivewireTable\Columns\BadgeColumn;

BadgeColumn::make('status')
    ->label('Status')
    ->colors([
        'active' => 'green',
        'inactive' => 'gray',
        'suspended' => 'red',
        'pending' => 'yellow',
    ])
    ->icons([
        'active' => '<circle cx="3" cy="3" r="3" />',
        'suspended' => '<path d="M6 18L18 6M6 6l12 12"/>',
    ])
    ->size('lg')  // sm, md, lg, xl
    ->format(fn($value) => match($value) {
        true, 1 => 'Aktivn√≠',
        false, 0 => 'Neaktivn√≠',
        default => 'Nezn√°m√Ω'
    })
```

#### ImageColumn

Sloupcec pro zobrazen√≠ obr√°zk≈Ø a avatar≈Ø.

```php
use NyonCode\LivewireTable\Columns\ImageColumn;

ImageColumn::make('avatar')
    ->label('Avatar')
    ->circular()  // Kulat√Ω obr√°zek
    ->size('md')  // sm, md, lg
    ->defaultImage('https://ui-avatars.com/api/?name=User')
```

#### EditableColumn

Editovateln√Ω sloupec p≈ô√≠mo v tabulce (inline editing).

```php
use NyonCode\LivewireTable\Columns\EditableColumn;

EditableColumn::make('name')
    ->label('Jm√©no')
    ->inputType('text')  // text, number, select, date, textarea
    ->rules('required|min:3')
    ->options([  // Pro select
        'option1' => 'Label 1',
        'option2' => 'Label 2',
    ])
    ->onSave(function ($record, $value) {
        $record->update(['name' => $value]);
        $this->dispatch('notify', ['message' => 'Ulo≈æeno']);
    })
```

#### Custom Column

Vytvo≈ô vlastn√≠ typ sloupce:

```php
use NyonCode\LivewireTable\Columns\Column;
use Illuminate\Database\Eloquent\Model;

class MyColumn extends Column
{
    public function formatValue(mixed $value, Model $record): mixed
    {
        return strtoupper($value);
    }
    
    public function render(): string
    {
        return view('components.table.columns.my-column', [
            'column' => $this,
            'record' => $this->record,
            'value' => $this->getFormattedValue($this->record),
        ])->render();
    }
}
```

---

### Relationships (Vztahy)

Pln√° podpora Eloquent vztah≈Ø pomoc√≠ **dot notation**:

```php
// Jednoduch√Ω vztah
TextColumn::make('department.name')
    ->label('Oddƒõlen√≠')
    ->searchable()
    ->sortable()

// Vno≈ôen√Ω vztah
TextColumn::make('user.company.name')
    ->label('Firma')

// Automatick√Ω eager loading
// RelationshipResolver automaticky naƒçte v≈°echny relationships
```

**Filtry pro relationships:**

```php
TextFilter::make('company_name', 'company.name')
    ->label('Firma')
    ->placeholder('Hledat firmu...')

SelectFilter::make('department_id', 'department.id')
    ->label('Oddƒõlen√≠')
    ->options(Department::pluck('name', 'id'))
```

---

### Filtry (Filters)

#### TextFilter

```php
use NyonCode\LivewireTable\Filters\TextFilter;

TextFilter::make('name_filter', 'name')
    ->label('Jm√©no')
    ->placeholder('Hledat...')
    ->operator('like')  // like, =, !=, >, <, >=, <=
```

#### SelectFilter

```php
use NyonCode\LivewireTable\Filters\SelectFilter;

SelectFilter::make('status_filter', 'status')
    ->label('Status')
    ->options([
        'active' => 'Aktivn√≠',
        'inactive' => 'Neaktivn√≠',
    ])
    ->placeholder('Vyberte status')
```

#### DateFilter

```php
use NyonCode\LivewireTable\Filters\DateFilter;

DateFilter::make('created_after', 'created_at')
    ->label('Od data')
    ->operator('>=')
```

#### Global Filters

Filtry ve dropdown menu m√≠sto pod sloupci:

```php
->globalFilters([
    SelectFilter::make('department_id', 'department.id')
        ->label('Oddƒõlen√≠')
        ->options(Department::pluck('name', 'id'))
        ->global(),
])
```

---

### Akce (Actions)

#### Jednoduch√° akce

```php
use NyonCode\LivewireTable\Actions\Action;

Action::make('edit')
    ->label('Upravit')
    ->icon('<path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5"/>') 
    ->color('blue')
    ->action(function ($record) {
        return redirect()->route('users.edit', $record);
    })
```

#### Akce s potvrzen√≠m

```php
Action::make('delete')
    ->label('Smazat')
    ->color('red')
    ->requireConfirmation(
        'Smazat u≈æivatele?',
        'Tato akce je nevratn√°.'
    )
    ->action(function ($record) {
        $record->delete();
    })
```

#### Akce s mod√°lem

```php
use NyonCode\LivewireTable\Actions\Modal;

Action::make('details')
    ->label('Detail')
    ->modal(
        Modal::make('Detail u≈æivatele')
            ->info('Zde jsou detailn√≠ informace')
            ->size('lg')  // sm, md, lg, xl, full
    )
```

---

### Bulk Actions (Hromadn√© akce)

```php
use NyonCode\LivewireTable\Actions\BulkAction;

->bulkActions([
    BulkAction::make('activate')
        ->label('Aktivovat vybran√©')
        ->color('green')
        ->action(function ($records) {
            $records->each->update(['status' => 'active']);
        }),
    
    BulkAction::make('delete')
        ->label('Smazat vybran√©')
        ->color('red')
        ->requireConfirmation()
        ->action(function ($records) {
            $records->each->delete();
        }),
])
```

---

### Grouping (Seskupov√°n√≠)

```php
->groupBy('department.name')
->groupHeader(function ($key, $items) {
    return sprintf('%s (%d u≈æivatel≈Ø)', $key, $items->count());
})
->collapsibleGroups(true)
```

**S custom logikou:**

```php
->groupBy('created_at', function ($item) {
    return $item->created_at->format('Y-m');
})
->groupHeader(function ($key, $items) {
    $total = $items->sum('salary');
    return "$key - Celkem: " . number_format($total) . " Kƒç";
})
```

---

### Sub-rows (Vno≈ôen√© ≈ô√°dky)

```php
->subRows('posts', function ($posts, $user) {
    return view('tables.user-posts', [
        'posts' => $posts,
        'user' => $user,
    ])->render();
})
->lazyLoadSubRows(true)
```

---

### Column Toggle (Skr√Ωv√°n√≠ sloupc≈Ø)

```php
->enableColumnToggle(true)
->alwaysVisible(['name', 'email'])  // Tyto sloupce nelze skr√Ωt
```

---

### Saved Filters (Ulo≈æen√© filtry)

```php
->enablePresets(true)
```

**Programaticky:**

```php
// V Livewire komponentƒõ
public function saveMyPreset()
{
    $this->savePreset('Aktivn√≠ u≈æivatel√©', [
        'status' => 'active',
        'department_id' => 1,
    ], isDefault: true);
}
```

---

### Responsive Design

```php
->scheme([
    'mobile' => ['stack'],   // Karty m√≠sto tabulky
    'tablet' => ['scroll'],  // Horizont√°ln√≠ scroll
    'desktop' => ['full'],   // Pln√° tabulka
])
```

**Per-column responsive:**

```php
TextColumn::make('description')
    ->hideOn(['sm', 'md'])  // Skryj na mobilu a tabletu
```

---

### Live Updates

```php
->liveUpdate(60)  // Auto-refresh ka≈æd√Ωch 60 sekund
```

---

### Pagination

```php
->perPage(25)
->pageOptions([10, 25, 50, 100])
```

---

## üîß Pokroƒçil√© pou≈æit√≠

### Enum Support

Automatick√° detekce PHP 8.1+ enums:

```php
// Model
enum UserStatus: string
{
    case ACTIVE = 'active';
    case INACTIVE = 'inactive';
}

protected $casts = [
    'status' => UserStatus::class,
];

// Table
BadgeColumn::make('status')
    ->colors([
        'active' => 'green',
        'inactive' => 'gray',
    ])
```

### Podm√≠nƒõn√° viditelnost sloupc≈Ø

```php
TextColumn::make('internal_notes')
    ->visible(auth()->user()->isAdmin())

TextColumn::make('debug_info')
    ->hidden(fn() => !config('app.debug'))
```

---

## üêõ Troubleshooting

### "Object could not be converted to string"

**≈òe≈°en√≠:** Pou≈æij `{!! $this->table->render() !!}` m√≠sto `{{ $this->table }}`

### "Undefined variable $tableSearch"

**≈òe≈°en√≠:** Zkontroluj, ≈æe pou≈æ√≠v√°≈° trait `HasTable` v Livewire komponentƒõ:

```php
use NyonCode\LivewireTable\Livewire\Concerns\HasTable;

class MyTable extends Component
{
    use HasTable;
    
    // ...
}
```

### "Method resetPage does not exist"

**≈òe≈°en√≠:** Trait `HasTable` u≈æ obsahuje `WithPagination`, nemus√≠≈° ho p≈ôid√°vat ruƒçnƒõ.

### Badge barvy se neaplikuj√≠

**≈òe≈°en√≠:**
1. P≈ôidej barvy do Tailwind `safelist` (viz instalace)
2. Spus≈• `npm run build`
3. Nepou≈æ√≠vej dynamick√© t≈ô√≠dy typu `bg-{{ $color }}-100`

### Filtry se nezobrazuj√≠ pod sloupci

**≈òe≈°en√≠:** Druh√Ω parametr filtru mus√≠ odpov√≠dat `field` sloupce:

```php
// SPR√ÅVNƒö
TextColumn::make('name'),
TextFilter::make('name_filter', 'name'),  // 'name' odpov√≠d√° field

// ≈†PATNƒö
TextColumn::make('name'),
TextFilter::make('name_filter', 'username'),  // Neshoduje se
```

---

## üìä P≈ô√≠klady pou≈æit√≠

### E-commerce objedn√°vky

```php
public function table(Table $table): Table
{
    return $table
        ->model(Order::with(['customer', 'items']))
        ->columns([
            TextColumn::make('order_number')
                ->label('ƒå√≠slo objedn√°vky')
                ->searchable()
                ->copyable(),
            
            TextColumn::make('customer.name')
                ->label('Z√°kazn√≠k')
                ->searchable(),
            
            BadgeColumn::make('status')
                ->colors([
                    'pending' => 'yellow',
                    'processing' => 'blue',
                    'completed' => 'green',
                    'cancelled' => 'red',
                ]),
            
            TextColumn::make('total')
                ->format(fn($value) => number_format($value, 2) . ' Kƒç'),
        ])
        ->groupBy('status')
        ->subRows('items', function ($items) {
            return view('tables.order-items', compact('items'))->render();
        });
}
```

---

## ü§ù Contributing

Pull requesty jsou v√≠t√°ny! Pro vƒõt≈°√≠ zmƒõny pros√≠m nejprve otev≈ôete issue.

## üìÑ License

MIT License - viz [LICENSE](LICENSE)

## üë®‚Äçüíª Autor

Vytvo≈ôeno s ‚ù§Ô∏è [NyonCode](https://nyoncode.cz)

**Ond≈ôej Nykl√≠ƒçek**  
üìß ondrej@nyoncode.cz

---

## üîó Related Resources

- [Laravel Documentation](https://laravel.com/docs)
- [Livewire 3 Documentation](https://livewire.laravel.com)
- [Tailwind CSS](https://tailwindcss.com)
- [Alpine.js](https://alpinejs.dev)

---

**Happy coding! üéâ**